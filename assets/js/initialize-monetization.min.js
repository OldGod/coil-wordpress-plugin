/*! Coil Monetize Content for WordPress v1.0.1 Friday 29th November 2019 10:40:21 AM GMT+0000 */
!function(a){if("undefined"==typeof coil_params)return;var t=coil_params.content_container,e=coil_params.browser_extension_missing,o=coil_params.unable_to_verify,n=coil_params.voluntary_donation,i=coil_params.loading_content,s=coil_params.post_excerpt,r=coil_params.admin_missing_id_notice;site_logo=coil_params.site_logo;var c=wp.template("subscriber-only-message"),d=wp.template("split-content-message"),l=wp.template("banner-message"),m=a("p.monetize-msg"),u=!0;function p(e){!1!==u&&console.info(e)}function g(e,t){var o=document.createElement("p");return o.classList.add("monetize-msg"),t&&o.classList.add(t),o.innerHTML=e,o}function b(e){var t=document.createElement("div");t.classList.add("entry-content","coil-message-container");var o={headerLogo:site_logo,title:"This content is for subscribers only",content:e,button:{text:"Get coil to access",href:"https://coil.com/learn-more/"}};return a(t).append(c(o)),t}function f(e){var t=document.createElement("div");t.classList.add("coil-banner-message-container");var o={content:e,button:{text:"Get Coil to access",href:"https://coil.com/learn-more/"}};return a(t).append(l(o)),t}function y(){p("Showing content container"),document.querySelector(t).style.display="block"}function h(){if(""!==s)return jQuery("<p>").addClass("coil-post-excerpt").text(s).prop("outerHTML")}function z(){return jQuery("p.coil-post-excerpt").hide()}function v(){return document.body.classList.contains("coil-no-gating")}function w(){return document.body.classList.contains("coil-gate-all")}function C(){return document.body.classList.contains("coil-gate-tagged-blocks")}function x(){return".content-area .entry-content"===t}function S(){return!!document.body.classList.contains("coil-show-excerpt")}function L(){if(p("Verification Failure"),0<a("p.monetize-msg").length)if(a("p.monetize-msg").remove(),w()){var e=a("p.coil-post-excerpt");0<e.length?e.after(g(o,"monetize-failed")):(document.body.classList.add("show-fw-message"),a(t).before(b(o)))}else C()?(a("body").addClass("coil-split"),y(),document.querySelector(t).before(g(o,"monetize-failed")),p("Unable to verify hidden content")):(document.body.classList.add("show-fw-message"),document.querySelector(t).before(b(o)),p("No tagged blocks"))}function _(t){a("#js-coil-banner-dismiss").on("click",function(e){1==!Cookies.get("ShowCoilPartialMsg")&&(!1!==t?Cookies.set("ShowCoilPartialMsg",1,{expires:t}):Cookies.set("ShowCoilPartialMsg",1),a(this).parent().parent().remove())})}a(document).ready(function(){document.body.classList.contains("monetization-not-initialized")&&(w()&&void 0!==s&&void 0!==document.monetization&&"stopped"!==document.monetization.state&&""!==s&&document.querySelector(t).before(h()),v()||x()||a(t).not(".coil-post-excerpt").hide(),void 0!==document.monetization?("pending"===document.monetization.state?a("body").hasClass("coil-missing-id")?(a("body").hasClass("coil-show-admin-notice")?a(t).before('<p class="monetize-msg">'+r+"</p>"):a("body").removeClass("coil-missing-id"),v()||x()||(y(),a(t+"*.coil-hide-monetize-users").css("display","none"),a(t+"*.coil-show-monetize-users").css("display","none")),a("body").trigger("coil-missing-id")):v()||(w()?""!==s?(p("Subscriber gating and no post excerpt...Verifying extension"),document.querySelector(t).before(g(i,""))):(p("Subscriber gating and has post excerpt...Verifying extension"),a("div.coil-post-excerpt").after(g(i,""))):document.querySelector(t).before(g(i,"")),setTimeout(function(){p("Verifying Coil account"),m.html(i)},2e3),setTimeout(function(){L()},5e3)):"started"===document.monetization.state?(p("Monetization state: Started"),document.querySelector(t).before(g(i,""))):"stopped"===document.monetization.state&&(p("Status stopped and Monetized and Public"),w()?(S()&&""!==s&&document.querySelector(t).insertAdjacentHTML("beforebegin",h()),document.querySelector(t).insertAdjacentHTML("beforebegin",'<p class="monetize-msg">'+i+"</p>")):C()&&document.querySelector(t).insertAdjacentHTML("beforebegin",'<p class="monetize-msg">'+i+"</p>"),setTimeout(function(){"undefined"==typeof monetizationStartEventOccurred&&(a("p.monetize-msg").text()===i?(p("Monetization not started and verification failed"),L()):v()&&(p("Content is monetized and public but extension is stopped"),1==!Cookies.get("ShowCoilPartialMsg")&&a("body").append(f(n)),_(31)))},5e3)),document.monetization.addEventListener("monetizationstart",function(e){e.detail.paymentPointer,e.detail.requestId;monetizationStartEventOccurred=!0,v()||x()||(y(),document.body.classList.remove("show-fw-message"),S()&&z()),a("body").removeClass("monetization-not-initialized").addClass("monetization-initialized"),m.remove(),S()||a("div.coil-post-excerpt").remove(),document.querySelectorAll("iframe, object, video").forEach(function(e){if(e.classList.contains("intrinsic-ignore")||e.parentNode.classList.contains("intrinsic-ignore"))return!0;e.dataset.origwidth||(e.setAttribute("data-origwidth",e.width),e.setAttribute("data-origheight",e.height))}),a("body").trigger("coil-monetization-initialized",[e]),0<a("p.monetize-msg").length&&(a("p.monetize-msg").remove(),z(),y())}),document.monetization.addEventListener("monetizationprogress",function(e){var t=e.detail.paymentPointer,o=e.detail.requestId,n=e.detail.amount,i=e.detail.assetCode,s=e.detail.assetScale;a("body").trigger("coil-monetization-progress",[e,t,o,n,i,s])})):(p("Coil Extension not found or using unsupported browser"),a("body").removeClass("monetization-not-initialized").addClass("coil-extension-not-found"),w()?(x()?a(t).before(b(e)):a(t).html(b(e)),S()?(document.body.classList.add("show-excerpt-message"),a(t).prepend(h())):document.body.classList.add("show-fw-message")):C()?(p("Split content with no extension found"),1==!Cookies.get("ShowCoilPartialMsg")&&a("body").append(f("This content is for Coil subscribers only.  To access, subscribe to Coil and install the browser extension.")),a(".coil-show-monetize-users").prepend(function(e){return d(e)}("This content is for Coil subscribers only! To access, visit coil.com and install the browser extension!")),_(!1)):v()&&(p("Content is monetized and public but no extension found"),1==!Cookies.get("ShowCoilPartialMsg")&&a("body").append(f(n)),_(31)),a("body").trigger("coil-extension-not-found")))})}(jQuery);
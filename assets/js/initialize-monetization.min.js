/*! Coil Monetize Content for WordPress v1.0.1 Tuesday 26th November 2019 18:46:40 PM GMT+0000 */
!function(r){if("undefined"==typeof coil_params)return;var t=coil_params.content_container,e=coil_params.browser_extension_missing,o=coil_params.unable_to_verify,n=coil_params.voluntary_donation,i=coil_params.loading_content,s=coil_params.post_excerpt,a=coil_params.admin_missing_id_notice,c=wp.template("full-width-message"),d=r("p.monetize-msg"),l=!0;function m(e){!1!==l&&console.info(e)}function u(e,t){var o=document.createElement("p");return o.classList.add("monetize-msg"),t&&o.classList.add(t),o.innerHTML=e,o}function p(e){var t=document.createElement("div");t.classList.add("entry-content","coil-message-container");var o={headerLogo:{src:"https://www.placehold.it/169x73/CDCDCD/000000?text=Site+logo&font=source-sans-pro",alt:"Alt text"},title:"This content is for subscribers only",content:e,button:{text:"Get coil to access",href:"https://coil.com/learn-more/"},footerLogo:{src:"https://www.placehold.it/175x75",alt:"Alt text"}};return r(t).append(c(o)),t}function f(){m("Showing content container"),document.querySelector(t).style.display="block"}function g(){if(""!==s)return jQuery("<p>").addClass("coil-post-excerpt").text(s).prop("outerHTML")}function b(){return document.body.classList.contains("coil-no-gating")}function y(){return document.body.classList.contains("coil-gate-all")}function z(){return".content-area .entry-content"===t}function h(){return!!document.body.classList.contains("coil-show-excerpt")}function v(){if(m("Verification Failure"),0<r("p.monetize-msg").length)if(r("p.monetize-msg").remove(),y()){var e=r("div.coil-post-excerpt");0<e.length?e.after(u(o,"monetize-failed")):(document.body.classList.add("show-fw-message"),document.querySelector(".site-main").before(p(o)))}else document.body.classList.contains("coil-gate-tagged-blocks")?(r("body").addClass("coil-split"),f(),document.querySelector(t).before(u(o,"monetize-failed")),m("Unable to verify hidden content")):(document.querySelector(t).before(u(o,"monetize-failed")),m("No tagged blocks"))}r(document).ready(function(){document.body.classList.contains("monetization-not-initialized")&&(y()&&void 0!==s&&void 0!==document.monetization&&"stopped"!==document.monetization.state&&""!==s&&document.querySelector(t).before(g()),b()||z()||document.querySelector(t).not(".coil-post-excerpt").hide(),void 0!==document.monetization?("pending"===document.monetization.state?r("body").hasClass("coil-missing-id")?(r("body").hasClass("coil-show-admin-notice")?r(t).before('<p class="monetize-msg">'+a+"</p>"):r("body").removeClass("coil-missing-id"),b()||z()||(f(),r(t+"*.coil-hide-monetize-users").css("display","none"),r(t+"*.coil-show-monetize-users").css("display","none")),r("body").trigger("coil-missing-id")):b()||(y()?""!==s?(m("Subscriber gating and no post excerpt...Verifying extension"),document.querySelector(t).before(u(i,""))):(m("Subscriber gating and has post excerpt...Verifying extension"),r("div.coil-post-excerpt").after(u(i,""))):document.querySelector(t).before(u(i,"")),setTimeout(function(){m("Verifying Coil account"),d.html(i)},2e3),setTimeout(function(){v()},5e3)):"started"===document.monetization.state?(m("Monetization state: Started"),document.querySelector(t).before(u(i,""))):"stopped"===document.monetization.state&&(b()||(m("Status stopped and Monetized and Public"),h()&&""!==s&&document.querySelector(t).insertAdjacentHTML("beforebegin",g()),document.querySelector(t).insertAdjacentHTML("beforebegin",'<p class="monetize-msg">'+i+"</p>")),setTimeout(function(){"undefined"==typeof monetizationStartEventOccurred&&(r("p.monetize-msg").text()===i?(m("Monetization not started and verification failed"),v()):b()&&(m("Content is monetized and public but extension is stopped"),document.querySelector(t).before(u(n,""))))},5e3)),document.monetization.addEventListener("monetizationstart",function(e){e.detail.paymentPointer,e.detail.requestId;monetizationStartEventOccurred=!0,b()||z()||f(),r("body").removeClass("monetization-not-initialized").addClass("monetization-initialized"),d.remove(),h()||r("div.coil-post-excerpt").remove(),document.querySelectorAll("iframe, object, video").forEach(function(e){if(e.classList.contains("intrinsic-ignore")||e.parentNode.classList.contains("intrinsic-ignore"))return!0;e.dataset.origwidth||(e.setAttribute("data-origwidth",e.width),e.setAttribute("data-origheight",e.height))}),r("body").trigger("coil-monetization-initialized",[e]),0<r("p.monetize-msg").length&&(r("p.monetize-msg").remove(),f())}),document.monetization.addEventListener("monetizationprogress",function(e){var t=e.detail.paymentPointer,o=e.detail.requestId,n=e.detail.amount,i=e.detail.assetCode,s=e.detail.assetScale;r("body").trigger("coil-monetization-progress",[e,t,o,n,i,s])})):(m("Coil Extension not found or using unsupported browser"),r("body").removeClass("monetization-not-initialized").addClass("coil-extension-not-found"),!y()&&b()||(h()?(document.body.classList.add("show-excerpt-message"),document.querySelector(t).before(g()),document.querySelector(t).before(p(e))):document.querySelector(".site-main").before(p(e))),b()?(m("Content is monetized and public but no extension found"),r(t).before(u(n,""))):z()||(f(),r(t+"*.coil-hide-monetize-users").css("display","none"),r(t+"*.coil-show-monetize-users").css("display","none")),r("body").trigger("coil-extension-not-found")))})}(jQuery);